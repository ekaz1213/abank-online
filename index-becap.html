<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê –ë–ê–ù–ö - –ü—Ä–µ–º–∏—É–º –ë–∞–Ω–∫–∏–Ω–≥</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: #2d3748;
        }
        
        .app {
            width: 100%;
            max-width: 480px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 24px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.1;
        }
        
        .logo {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 8px;
            position: relative;
        }
        
        .subtitle {
            opacity: 0.9;
            font-size: 14px;
            font-weight: 500;
        }
        
        .content {
            padding: 25px;
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .card {
            background: white;
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.06);
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 16px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            margin-bottom: 16px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #f8fafc;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: white;
        }
        
        button {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 12px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        button:hover::before {
            left: 100%;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }
        
        .balance {
            font-size: 36px;
            font-weight: 800;
            color: #1e293b;
            margin: 12px 0;
            text-align: center;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .nav-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 20px;
        }
        
        .nav-btn {
            background: white;
            border: 2px solid #e2e8f0;
            padding: 20px 12px;
            border-radius: 16px;
            text-align: center;
            cursor: pointer;
            font-size: 14px;
            color: #2d3748;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .nav-btn:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }
        
        .operation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: #f8fafc;
            border-radius: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
            transition: all 0.3s ease;
        }
        
        .operation:hover {
            background: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .badge {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            margin-left: 8px;
        }
        
        .badge-success {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .badge-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .badge-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        .hidden {
            display: none !important;
        }
        
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            background: #f8fafc;
            padding: 6px;
            border-radius: 12px;
        }
        
        .tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            color: #64748b;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            background: white;
            color: #667eea;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
            animation: modalSlideIn 0.3s ease;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 16px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 800;
            margin: 8px 0;
        }
        
        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: #f8fafc;
            border-radius: 12px;
            margin-bottom: 10px;
        }
        
        .user-actions {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            width: auto;
        }
        
        .promo-card {
            background: linear-gradient(135deg, #f0f4ff, #f8fafc);
            border: 2px dashed #cbd5e1;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 15px;
        }
        
        @media (max-width: 480px) {
            .content {
                padding: 20px;
            }
            
            .card {
                padding: 20px;
            }
            
            .nav-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .header {
                padding: 25px 20px;
            }
        }
        
        @media (min-width: 768px) {
            .app {
                max-width: 500px;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="header">
            <div class="logo">–ê –ë–ê–ù–ö</div>
            <div class="subtitle">–ü—Ä–µ–º–∏—É–º –ë–∞–Ω–∫–∏–Ω–≥</div>
        </div>
        
        <div class="content">
            <!-- –õ–æ–≥–∏–Ω -->
            <div id="loginView">
                <div class="card">
                    <h3 style="text-align: center; margin-bottom: 20px;">–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h3>
                    <input type="email" id="loginEmail" placeholder="–í–∞—à email" value="user@example.com">
                    <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å" value="user123">
                    <button onclick="login()">üîê –í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</button>
                    <button class="btn-secondary" onclick="showView('register')">‚ú® –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
                </div>
            </div>

            <!-- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è -->
            <div id="registerView" class="hidden">
                <div class="card">
                    <h3 style="text-align: center; margin-bottom: 20px;">–°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ <span class="badge">+500‚ÇΩ</span></h3>
                    <input type="text" id="regName" placeholder="–ò–º—è">
                    <input type="text" id="regLastName" placeholder="–§–∞–º–∏–ª–∏—è">
                    <input type="email" id="regEmail" placeholder="Email">
                    <input type="tel" id="regPhone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
                    <input type="password" id="regPassword" placeholder="–ü–∞—Ä–æ–ª—å">
                    <button onclick="register()">üéÅ –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç + 500‚ÇΩ</button>
                    <button class="btn-secondary" onclick="showView('login')">‚Üê –ù–∞–∑–∞–¥ –∫ –≤—Ö–æ–¥—É</button>
                </div>
            </div>

            <!-- –î–∞—à–±–æ—Ä–¥ -->
            <div id="dashboardView" class="hidden">
                <div class="card">
                    <h3 id="userWelcome" style="text-align: center;">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h3>
                    <div class="balance" id="userBalance">0 ‚ÇΩ</div>
                    
                    <div class="nav-grid">
                        <div class="nav-btn" onclick="showView('transfer')">
                            <div style="font-size: 20px; margin-bottom: 5px;">üí∏</div>
                            –ü–µ—Ä–µ–≤–æ–¥
                        </div>
                        <div class="nav-btn" onclick="applyCard()">
                            <div style="font-size: 20px; margin-bottom: 5px;">üí≥</div>
                            –ö–∞—Ä—Ç–∞
                        </div>
                        <div class="nav-btn" onclick="showView('history')">
                            <div style="font-size: 20px; margin-bottom: 5px;">üìä</div>
                            –ò—Å—Ç–æ—Ä–∏—è
                        </div>
                        <div class="nav-btn" onclick="showView('profile')">
                            <div style="font-size: 20px; margin-bottom: 5px;">üë§</div>
                            –ü—Ä–æ—Ñ–∏–ª—å
                        </div>
                        <div class="nav-btn" onclick="showView('promo')">
                            <div style="font-size: 20px; margin-bottom: 5px;">üé´</div>
                            –ü—Ä–æ–º–æ–∫–æ–¥—ã
                        </div>
                        <div class="nav-btn" onclick="showView('admin')" id="adminNav">
                            <div style="font-size: 20px; margin-bottom: 5px;">üëë</div>
                            –ê–¥–º–∏–Ω
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h4 style="margin-bottom: 15px;">üìà –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h4>
                    <div id="recentOperations">–û–ø–µ—Ä–∞—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</div>
                </div>
                
                <button class="btn-secondary" onclick="logout()">üö™ –í—ã–π—Ç–∏</button>
            </div>

            <!-- –ü–µ—Ä–µ–≤–æ–¥—ã -->
            <div id="transferView" class="hidden">
                <div class="card">
                    <h3 style="text-align: center; margin-bottom: 20px;">üí∏ –ü–µ—Ä–µ–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h3>
                    
                    <div class="tabs">
                        <div class="tab active" onclick="setTransferType('email')">üìß Email</div>
                        <div class="tab" onclick="setTransferType('phone')">üì± –¢–µ–ª–µ—Ñ–æ–Ω</div>
                        <div class="tab" onclick="setTransferType('card')">üí≥ –ö–∞—Ä—Ç–∞</div>
                    </div>
                    
                    <input type="text" id="transferTo" placeholder="Email –ø–æ–ª—É—á–∞—Ç–µ–ª—è">
                    <input type="number" id="transferAmount" placeholder="–°—É–º–º–∞ –ø–µ—Ä–µ–≤–æ–¥–∞">
                    <input type="text" id="transferDesc" placeholder="–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞">
                    <button onclick="makeTransfer()">üöÄ –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥</button>
                    <button class="btn-secondary" onclick="showView('dashboard')">‚Üê –ù–∞–∑–∞–¥</button>
                </div>
            </div>

            <!-- –ò—Å—Ç–æ—Ä–∏—è -->
            <div id="historyView" class="hidden">
                <div class="card">
                    <h3 style="text-align: center; margin-bottom: 20px;">üìä –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h3>
                    <div id="operationsList">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    <button class="btn-secondary" onclick="showView('dashboard')">‚Üê –ù–∞–∑–∞–¥</button>
                </div>
            </div>

            <!-- –ü—Ä–æ—Ñ–∏–ª—å -->
            <div id="profileView" class="hidden">
                <div class="card">
                    <h3 style="text-align: center; margin-bottom: 20px;">üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h3>
                    <div id="profileInfo">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    <button onclick="showPassportModal()">üÜî –ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
                    <button class="btn-success" onclick="requestVerification()" id="verifyBtn">‚úÖ –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é</button>
                    <button class="btn-secondary" onclick="showView('dashboard')">‚Üê –ù–∞–∑–∞–¥</button>
                </div>
            </div>

            <!-- –ü—Ä–æ–º–æ–∫–æ–¥—ã -->
            <div id="promoView" class="hidden">
                <div class="card">
                    <h3 style="text-align: center; margin-bottom: 20px;">üé´ –ü—Ä–æ–º–æ–∫–æ–¥—ã</h3>
                    <input type="text" id="promoCode" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥">
                    <button onclick="activatePromo()">üéÅ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</button>
                    <div id="activePromos" style="margin-top: 20px;">
                        <h4>–ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã:</h4>
                        <div id="promosList">–ü—Ä–æ–º–æ–∫–æ–¥–æ–≤ –Ω–µ—Ç</div>
                    </div>
                    <button class="btn-secondary" onclick="showView('dashboard')">‚Üê –ù–∞–∑–∞–¥</button>
                </div>
            </div>

            <!-- –ê–¥–º–∏–Ω -->
            <div id="adminView" class="hidden">
                <div class="card">
                    <h3 style="text-align: center; margin-bottom: 20px;">üëë –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h3>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
                            <div class="stat-value" id="adminTotalUsers">0</div>
                        </div>
                        <div class="stat-card">
                            <div>‚úÖ –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã</div>
                            <div class="stat-value" id="adminVerifiedUsers">0</div>
                        </div>
                        <div class="stat-card">
                            <div>üí≥ –ö–∞—Ä—Ç—ã</div>
                            <div class="stat-value" id="adminTotalCards">0</div>
                        </div>
                        <div class="stat-card">
                            <div>üí∞ –ë–∞–ª–∞–Ω—Å</div>
                            <div class="stat-value" id="adminTotalBalance">0‚ÇΩ</div>
                        </div>
                    </div>

                    <button onclick="showModal('usersModal')">üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</button>
                    <button onclick="showModal('promoModal')" class="btn-success">üé´ –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</button>
                    <button onclick="resetDB()" class="btn-danger">üóëÔ∏è –°–±—Ä–æ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</button>
                    <button class="btn-secondary" onclick="showView('dashboard')">‚Üê –ù–∞–∑–∞–¥</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div class="modal" id="passportModal">
        <div class="modal-content">
            <h3 style="text-align: center; margin-bottom: 20px;">üÜî –ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
            <input type="text" id="passportSeries" placeholder="–°–µ—Ä–∏—è –ø–∞—Å–ø–æ—Ä—Ç–∞" maxlength="4">
            <input type="text" id="passportNumber" placeholder="–ù–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞" maxlength="6">
            <input type="text" id="passportIssued" placeholder="–ö–µ–º –≤—ã–¥–∞–Ω">
            <input type="text" id="passportCode" placeholder="–ö–æ–¥ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è">
            <div style="display: flex; gap: 10px;">
                <button onclick="savePassport()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button class="btn-secondary" onclick="closeModal('passportModal')">‚ùå –û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <div class="modal" id="usersModal">
        <div class="modal-content">
            <h3 style="text-align: center; margin-bottom: 20px;">üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
            <div id="usersList" style="max-height: 300px; overflow-y: auto; margin-bottom: 20px;">
                –ó–∞–≥—Ä—É–∑–∫–∞...
            </div>
            <button class="btn-secondary" onclick="closeModal('usersModal')">‚ùå –ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div class="modal" id="promoModal">
        <div class="modal-content">
            <h3 style="text-align: center; margin-bottom: 20px;">üé´ –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</h3>
            <input type="text" id="promoName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞">
            <input type="text" id="promoCodeInput" placeholder="–ö–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞">
            <input type="number" id="promoAmount" placeholder="–°—É–º–º–∞ –±–æ–Ω—É—Å–∞">
            <input type="number" id="promoUses" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π">
            <input type="date" id="promoExpires" placeholder="–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ">
            <div style="display: flex; gap: 10px;">
                <button onclick="createPromo()">‚ú® –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥</button>
                <button class="btn-secondary" onclick="closeModal('promoModal')">‚ùå –û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script>
        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é
        let users = JSON.parse(localStorage.getItem('abank_users')) || JSON.parse(localStorage.getItem('bank_users')) || [];
        let operations = JSON.parse(localStorage.getItem('abank_operations')) || JSON.parse(localStorage.getItem('bank_operations')) || [];
        let promoCodes = JSON.parse(localStorage.getItem('abank_promos')) || [];
        let currentUser = null;
        let transferType = 'email';

        // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∞–¥–º–∏–Ω–∞ –µ—Å–ª–∏ –Ω–µ—Ç
        if (users.length === 0) {
            users.push({
                id: 'user_1',
                name: '–¢–µ—Å—Ç–æ–≤—ã–π', lastName: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                email: 'user@example.com', phone: '+79991112233',
                password: 'user123', balance: 5000,
                role: 'user', cards: [], verified: false,
                passport: null, activePromos: []
            });
            
            users.push({
                id: 'admin',
                name: '–ê–¥–º–∏–Ω', lastName: '–°–∏—Å—Ç–µ–º—ã',
                email: 'admin@abank.ru', phone: '+79990000000',
                password: 'Admin123!', balance: 100000,
                role: 'admin', cards: [], verified: true,
                passport: {series: '0000', number: '000000'},
                activePromos: []
            });
            
            // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã
            promoCodes.push({
                id: 'promo_1',
                code: 'WELCOME500',
                name: '–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±–æ–Ω—É—Å',
                amount: 500,
                maxUses: 100,
                usedCount: 0,
                expiresAt: '2024-12-31',
                createdBy: 'admin'
            });
            
            saveData();
        }

        function saveData() {
            localStorage.setItem('abank_users', JSON.stringify(users));
            localStorage.setItem('abank_operations', JSON.stringify(operations));
            localStorage.setItem('abank_promos', JSON.stringify(promoCodes));
        }

        function showView(viewName) {
            document.querySelectorAll('[id$="View"]').forEach(view => {
                view.classList.add('hidden');
            });
            document.getElementById(viewName + 'View').classList.remove('hidden');
            
            if (viewName === 'dashboard') loadDashboard();
            if (viewName === 'history') loadHistory();
            if (viewName === 'profile') loadProfile();
            if (viewName === 'admin') loadAdmin();
            if (viewName === 'promo') loadPromos();
        }

        function showModal(modalId) {
            if (modalId === 'usersModal') loadUsersList();
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // –õ–æ–≥–∏–Ω –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const user = users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                updateUI();
                showView('dashboard');
            } else {
                alert('‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
            }
        }

        function register() {
            const userData = {
                name: document.getElementById('regName').value,
                lastName: document.getElementById('regLastName').value,
                email: document.getElementById('regEmail').value,
                phone: document.getElementById('regPhone').value,
                password: document.getElementById('regPassword').value
            };
            
            if (users.find(u => u.email === userData.email)) {
                alert('‚ùå Email —É–∂–µ –∑–∞–Ω—è—Ç'); return;
            }
            
            const newUser = {
                id: 'user_' + Date.now(), ...userData,
                balance: 500, role: 'user', cards: [],
                verified: false, passport: null,
                activePromos: []
            };
            
            users.push(newUser);
            currentUser = newUser;
            
            operations.push({
                id: 'op_' + Date.now(), type: 'bonus',
                userId: newUser.id, amount: 500,
                description: '–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±–æ–Ω—É—Å –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é',
                at: new Date().toISOString()
            });
            
            saveData();
            updateUI();
            showView('dashboard');
            alert('üéâ –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! –ë–æ–Ω—É—Å 500 ‚ÇΩ –∑–∞—á–∏—Å–ª–µ–Ω');
        }

        // –ü–µ—Ä–µ–≤–æ–¥—ã
        function setTransferType(type) {
            transferType = type;
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            const placeholder = {
                'email': 'Email –ø–æ–ª—É—á–∞—Ç–µ–ª—è',
                'phone': '–¢–µ–ª–µ—Ñ–æ–Ω –ø–æ–ª—É—á–∞—Ç–µ–ª—è', 
                'card': '–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã'
            }[type];
            document.getElementById('transferTo').placeholder = placeholder;
        }

        function makeTransfer() {
            const to = document.getElementById('transferTo').value;
            const amount = Number(document.getElementById('transferAmount').value);
            const desc = document.getElementById('transferDesc').value;
            
            let recipient = users.find(u => 
                u.email === to || u.phone === to || 
                u.cards.some(c => c.number.includes(to))
            );
            
            if (!recipient) { alert('‚ùå –ü–æ–ª—É—á–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω'); return; }
            if (currentUser.balance < amount) { alert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤'); return; }
            
            currentUser.balance -= amount;
            recipient.balance += amount;
            
            operations.push({
                id: 'op_' + Date.now(), type: 'transfer',
                fromId: currentUser.id, toId: recipient.id,
                amount: amount, description: desc,
                at: new Date().toISOString()
            });
            
            saveData();
            updateUI();
            showView('dashboard');
            alert(`‚úÖ –ü–µ—Ä–µ–≤–æ–¥ ${amount} ‚ÇΩ –≤—ã–ø–æ–ª–Ω–µ–Ω!`);
        }

        // –ö–∞—Ä—Ç—ã
        function applyCard() {
            if (!currentUser.passport) {
                alert('‚ùå –î–ª—è –≤—ã–ø—É—Å–∫–∞ –∫–∞—Ä—Ç—ã –Ω—É–∂–Ω—ã –ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ'); 
                showView('profile'); 
                return;
            }
            if (!currentUser.verified) {
                alert('‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞'); 
                return;
            }
            
            const cardNumber = '5536 ' + Math.floor(1000 + Math.random() * 9000);
            currentUser.cards.push({
                number: cardNumber, 
                type: currentUser.role === 'admin' ? 'Mastercard Platinum' : 'Visa Classic',
                issuedAt: new Date().toISOString()
            });
            
            operations.push({
                id: 'op_' + Date.now(), 
                type: 'card_issue',
                userId: currentUser.id, 
                amount: 0,
                description: '–í—ã–ø—É—Å–∫ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç—ã',
                at: new Date().toISOString()
            });
            
            saveData();
            alert(`üí≥ –ö–∞—Ä—Ç–∞ –≤—ã–ø—É—â–µ–Ω–∞: ${cardNumber}`);
        }

        // –ü–∞—Å–ø–æ—Ä—Ç –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
        function showPassportModal() {
            showModal('passportModal');
        }

        function savePassport() {
            const passportData = {
                series: document.getElementById('passportSeries').value,
                number: document.getElementById('passportNumber').value,
                issued: document.getElementById('passportIssued').value,
                code: document.getElementById('passportCode').value
            };
            
            if (!passportData.series || !passportData.number) {
                alert('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–µ—Ä–∏—é –∏ –Ω–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞'); 
                return;
            }
            
            currentUser.passport = passportData;
            saveData();
            closeModal('passportModal');
            loadProfile();
            alert('‚úÖ –ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
        }

        function requestVerification() {
            if (!currentUser.passport) {
                alert('‚ùå –°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤—å—Ç–µ –ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ'); 
                return;
            }
            alert('üìã –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É');
        }

        // –ü—Ä–æ–º–æ–∫–æ–¥—ã
        function loadPromos() {
            const container = document.getElementById('promosList');
            if (!currentUser.activePromos || currentUser.activePromos.length === 0) {
                container.innerHTML = '<div class="operation">–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –Ω–µ—Ç</div>';
                return;
            }
            
            container.innerHTML = currentUser.activePromos.map(promoId => {
                const promo = promoCodes.find(p => p.id === promoId);
                if (!promo) return '';
                return `
                    <div class="promo-card">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>${promo.name}</strong>
                                <div style="font-size: 12px; color: #666;">–ö–æ–¥: ${promo.code}</div>
                            </div>
                            <span class="badge badge-success">+${promo.amount}‚ÇΩ</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function activatePromo() {
            const code = document.getElementById('promoCode').value.toUpperCase();
            const promo = promoCodes.find(p => p.code === code);
            
            if (!promo) {
                alert('‚ùå –ü—Ä–æ–º–æ–∫–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω'); 
                return;
            }
            
            if (promo.usedCount >= promo.maxUses) {
                alert('‚ùå –ü—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑'); 
                return;
            }
            
            if (new Date(promo.expiresAt) < new Date()) {
                alert('‚ùå –ü—Ä–æ–º–æ–∫–æ–¥ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω'); 
                return;
            }
            
            if (currentUser.activePromos && currentUser.activePromos.includes(promo.id)) {
                alert('‚ùå –í—ã —É–∂–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª–∏ —ç—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥'); 
                return;
            }
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø—Ä–æ–º–æ–∫–æ–¥
            currentUser.balance += promo.amount;
            if (!currentUser.activePromos) currentUser.activePromos = [];
            currentUser.activePromos.push(promo.id);
            promo.usedCount++;
            
            operations.push({
                id: 'op_' + Date.now(), 
                type: 'promo',
                userId: currentUser.id, 
                amount: promo.amount,
                description: `–ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞: ${promo.name}`,
                at: new Date().toISOString()
            });
            
            saveData();
            updateUI();
            document.getElementById('promoCode').value = '';
            loadPromos();
            alert(`üéâ –ü—Ä–æ–º–æ–∫–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! +${promo.amount} ‚ÇΩ –∑–∞—á–∏—Å–ª–µ–Ω—ã –Ω–∞ —Å—á–µ—Ç`);
        }

        function createPromo() {
            const name = document.getElementById('promoName').value;
            const code = document.getElementById('promoCodeInput').value.toUpperCase();
            const amount = Number(document.getElementById('promoAmount').value);
            const maxUses = Number(document.getElementById('promoUses').value);
            const expiresAt = document.getElementById('promoExpires').value;
            
            if (!name || !code || !amount || !maxUses || !expiresAt) {
                alert('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è'); 
                return;
            }
            
            if (promoCodes.find(p => p.code === code)) {
                alert('‚ùå –ü—Ä–æ–º–æ–∫–æ–¥ —Å —Ç–∞–∫–∏–º –∫–æ–¥–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç'); 
                return;
            }
            
            const newPromo = {
                id: 'promo_' + Date.now(),
                code: code,
                name: name,
                amount: amount,
                maxUses: maxUses,
                usedCount: 0,
                expiresAt: expiresAt,
                createdBy: currentUser.id,
                createdAt: new Date().toISOString()
            };
            
            promoCodes.push(newPromo);
            saveData();
            closeModal('promoModal');
            alert('‚úÖ –ü—Ä–æ–º–æ–∫–æ–¥ —Å–æ–∑–¥–∞–Ω!');
        }

        // –ê–¥–º–∏–Ω —Ñ—É–Ω–∫—Ü–∏–∏
        function loadAdmin() {
            document.getElementById('adminTotalUsers').textContent = users.length;
            document.getElementById('adminVerifiedUsers').textContent = users.filter(u => u.verified).length;
            document.getElementById('adminTotalCards').textContent = users.reduce((sum, user) => sum + user.cards.length, 0);
            document.getElementById('adminTotalBalance').textContent = users.reduce((sum, user) => sum + user.balance, 0) + '‚ÇΩ';
        }

        function loadUsersList() {
            const container = document.getElementById('usersList');
            container.innerHTML = users.map(user => `
                <div class="user-item">
                    <div>
                        <strong>${user.name} ${user.lastName}</strong>
                        <div style="font-size: 12px; color: #666;">${user.email}</div>
                        <div>–ë–∞–ª–∞–Ω—Å: ${user.balance} ‚ÇΩ</div>
                    </div>
                    <div class="user-actions">
                        ${!user.verified ? `<button class="action-btn btn-success" onclick="verifyUser('${user.id}')">‚úÖ</button>` : ''}
                        ${user.role !== 'admin' ? `<button class="action-btn btn-warning" onclick="makeAdmin('${user.id}')">üëë</button>` : ''}
                    </div>
                </div>
            `).join('');
        }

        function verifyUser(userId) {
            const user = users.find(u => u.id === userId);
            if (user) {
                user.verified = true;
                saveData();
                loadUsersList();
                alert(`‚úÖ ${user.name} –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω`);
            }
        }

        function makeAdmin(userId) {
            const user = users.find(u => u.id === userId);
            if (user) {
                user.role = 'admin';
                saveData();
                loadUsersList();
                alert(`üëë ${user.name} —Ç–µ–ø–µ—Ä—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä`);
            }
        }

        function resetDB() {
            if (confirm('‚ö†Ô∏è –í—ã —É–≤–µ—Ä–µ–Ω—ã? –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏!')) {
                localStorage.clear();
                location.reload();
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        function loadDashboard() {
            const userOps = operations.filter(op => 
                op.userId === currentUser.id || op.fromId === currentUser.id
            ).slice(-3).reverse();
            
            const container = document.getElementById('recentOperations');
            container.innerHTML = userOps.length ? userOps.map(op => `
                <div class="operation">
                    <div>${op.description}</div>
                    <div style="color: ${op.amount > 0 ? '#10b981' : '#ef4444'}; font-weight: 600;">
                        ${op.amount > 0 ? '+' : ''}${op.amount} ‚ÇΩ
                    </div>
                </div>
            `).join('') : '<div class="operation">–û–ø–µ—Ä–∞—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</div>';
        }

        function loadHistory() {
            const userOps = operations.filter(op => 
                op.userId === currentUser.id || op.fromId === currentUser.id
            ).reverse();
            
            document.getElementById('operationsList').innerHTML = userOps.length ? 
                userOps.map(op => `
                    <div class="operation">
                        <div>${op.description}</div>
                        <div style="color: ${op.amount > 0 ? '#10b981' : '#ef4444'}; font-weight: 600;">
                            ${op.amount > 0 ? '+' : ''}${op.amount} ‚ÇΩ
                        </div>
                    </div>
                `).join('') : '<div class="operation">–û–ø–µ—Ä–∞—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç</div>';
        }

        function loadProfile() {
            document.getElementById('profileInfo').innerHTML = `
                <div class="operation">
                    <div><strong>–ò–º—è:</strong> ${currentUser.name} ${currentUser.lastName}</div>
                </div>
                <div class="operation">
                    <div><strong>Email:</strong> ${currentUser.email}</div>
                </div>
                <div class="operation">
                    <div><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${currentUser.phone}</div>
                </div>
                <div class="operation">
                    <div><strong>–ë–∞–ª–∞–Ω—Å:</strong> ${currentUser.balance} ‚ÇΩ</div>
                </div>
                <div class="operation">
                    <div><strong>–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è:</strong> ${currentUser.verified ? '‚úÖ –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω' : '‚ùå –ù–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω'}</div>
                </div>
                <div class="operation">
                    <div><strong>–ü–∞—Å–ø–æ—Ä—Ç:</strong> ${currentUser.passport ? '‚úÖ –î–æ–±–∞–≤–ª–µ–Ω' : '‚ùå –ù–µ –¥–æ–±–∞–≤–ª–µ–Ω'}</div>
                </div>
            `;
            
            document.getElementById('verifyBtn').style.display = 
                currentUser.verified ? 'none' : 'block';
        }

        function updateUI() {
            if (currentUser) {
                document.getElementById('userWelcome').textContent = `–ü—Ä–∏–≤–µ—Ç, ${currentUser.name}!`;
                document.getElementById('userBalance').textContent = `${currentUser.balance} ‚ÇΩ`;
                
                if (currentUser.role === 'admin') {
                    document.getElementById('adminNav').style.display = 'block';
                } else {
                    document.getElementById('adminNav').style.display = 'none';
                }
            }
        }

        function logout() {
            currentUser = null;
            showView('login');
        }

        // –ó–∞–ø—É—Å–∫
        showView('login');
    </script>
</body>
</html>
